---
import Layout from '../../layouts/Layout.astro'
import InteractiveMenu from '../../components/InteractiveMenu.vue'
import BookingForm from '../../components/BookingForm.vue'
import { getCollection } from 'astro:content'
import aboutImage from '../../assets/about.jpg'
import signature from '../../assets/signature.png'
import { ui } from '../../i18n/ui'
import { useTranslations } from '../../i18n/utils'
import { Image } from 'astro:assets'
import ReviewCarousel from '../../components/ReviewCarousel.astro'
import Gallery from '../../components/Gallery.astro'
import HeroImg from '../../assets/hero.avif'
import OpeningStatus from '../../components/OpeningStatus.vue'

export function getStaticPaths() {
    return [{ params: { lang: 'sk' } }, { params: { lang: 'en' } }]
}

const { lang } = Astro.params
const t = useTranslations(lang as keyof typeof ui)

const menuItems = await getCollection('menu')

// Structured Data for SEO
const schema = {
    '@context': 'https://schema.org',
    '@type': 'Restaurant',
    name: 'LUNAR Bistro',
    image: 'https://lunar-bistro.sk/images/og-image.jpg', // Placeholder
    url: 'https://lunar-bistro.sk',
    telephone: '+421900000000',
    address: {
        '@type': 'PostalAddress',
        streetAddress: 'Michalsk치 12',
        addressLocality: 'Bratislava',
        postalCode: '81101',
        addressCountry: 'SK',
    },
    geo: {
        '@type': 'GeoCoordinates',
        latitude: 48.145,
        longitude: 17.107,
    },
    openingHoursSpecification: [
        {
            '@type': 'OpeningHoursSpecification',
            dayOfWeek: ['Monday', 'Tuesday', 'Wednesday', 'Thursday'],
            opens: '11:00',
            closes: '22:00',
        },
        {
            '@type': 'OpeningHoursSpecification',
            dayOfWeek: ['Friday', 'Saturday'],
            opens: '11:00',
            closes: '00:00',
        },
    ],
    servesCuisine: 'Modern European',
    priceRange: '$$$',
}
---

<Layout
    title="LUNAR Bistro | Modern치 Gastron칩mia v Bratislave"
    schema={schema}
    lang={lang}
>
    <!-- HERO SECTION -->
    <section
        class="relative h-screen flex items-center justify-center overflow-hidden"
    >
        <!-- Background Overlay -->
        <div class="absolute inset-0 bg-lunar-black/40 z-10"></div>
        <!-- Gradient overlay for text readability -->
        <div
            class="absolute inset-0 bg-gradient-to-t from-lunar-black via-transparent to-lunar-black/60 z-10"
        >
        </div>

        <!-- Video or Image Background (Placeholder) -->
        <div class="absolute inset-0 z-0 px-4 md:px-0">
            <!-- Assuming a dark elegant texture or image here. Using a solid color fallback for now 
                  In production, use <Image /> or <video> -->
            <Image
                src={HeroImg}
                alt="Restaurant Interior"
                class="w-full h-full object-cover animate-pulse-slow"
                loading="eager"
                fetchpriority="high"
            />
        </div>

        <div class="relative z-20 text-center px-6 max-w-4xl mx-auto pt-20">
            <span
                class="block text-lunar-gold tracking-[0.3em] uppercase text-sm md:text-base mb-6 animate-fade-in"
                >{t('hero.location')}</span
            >
            <h1
                class="text-5xl md:text-7xl lg:text-8xl font-serif text-lunar-white mb-8 leading-tight reveal-text"
            >
                <span>{t('hero.title.1')}</span>
                <span class="text-lunar-gold"> {t('hero.title.2')}</span>
            </h1>
            <p
                class="text-lunar-muted text-lg md:text-xl max-w-2xl mx-auto mb-12 font-light leading-relaxed animate-fade-in"
                style="animation-delay: 0.3s"
            >
                {t('hero.subtitle')}
            </p>
            <div
                class="flex flex-col md:flex-row gap-6 justify-center animate-fade-in"
                style="animation-delay: 0.6s"
            >
                <a
                    href="#rezervacia"
                    class="px-8 py-3 bg-lunar-gold text-lunar-black font-semibold hover:bg-white transition-colors duration-300 uppercase tracking-widest text-sm"
                >
                    {t('hero.cta.book')}
                </a>
                <a
                    href="#menu"
                    class="px-8 py-3 border border-lunar-white/30 text-lunar-white hover:border-lunar-gold hover:text-lunar-gold transition-colors duration-300 uppercase tracking-widest text-sm"
                >
                    {t('hero.cta.menu')}
                </a>
            </div>

            <OpeningStatus client:load lang={lang as 'sk' | 'en'} />
        </div>
    </section>

    <!-- STORY SECTION -->
    <section id="pribeh" class="py-24 md:py-32 bg-lunar-black relative">
        <div
            class="max-w-6xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-16 items-center"
        >
            <div class="order-2 md:order-1 relative">
                <div
                    class="w-full h-[500px] bg-neutral-900 overflow-hidden relative group"
                >
                    <!-- ... (inside the template) ... -->
                    <Image
                        src={aboutImage}
                        alt="Interior"
                        class="w-full h-full object-cover group-hover:grayscale-0 transition-all duration-700 opacity-80 group-hover:opacity-100"
                        loading="lazy"
                    />
                    <!-- Decor element -->
                    <div
                        class="absolute -bottom-6 -right-6 w-32 h-32 border border-lunar-gold/30 z-10 hidden md:block"
                    >
                    </div>
                </div>
            </div>
            <div class="order-1 md:order-2">
                <h2
                    class="text-xs text-lunar-gold tracking-[0.2em] uppercase mb-4"
                >
                    {t('story.subtitle')}
                </h2>
                <h3
                    class="text-4xl md:text-5xl font-serif text-lunar-white mb-8 whitespace-pre-line"
                >
                    {t('story.title')}
                </h3>
                <p class="text-lunar-muted leading-relaxed mb-6 font-light">
                    {t('story.text.1')}
                </p>
                <p class="text-lunar-muted leading-relaxed mb-8 font-light">
                    {t('story.text.2')}
                </p>
                <Image
                    src={signature}
                    alt="Signature"
                    class="h-12 w-auto opacity-50"
                    loading="lazy"
                />
            </div>
        </div>
    </section>

    <!-- MENU SECTION (Vue Island) -->
    <section id="menu" class="py-24 bg-lunar-dark relative">
        <div class="text-center mb-16 px-6">
            <span class="text-lunar-gold tracking-[0.2em] uppercase text-xs"
                >{t('menu.subtitle')}</span
            >
            <h2 class="text-4xl md:text-6xl font-serif text-lunar-white mt-3">
                {t('menu.title')}
            </h2>
        </div>

        <InteractiveMenu
            client:visible
            items={menuItems}
            initialLang={lang as 'sk' | 'en'}
        />
    </section>

    <!-- REVIEWS SECTION -->
    <ReviewCarousel lang={lang as 'sk' | 'en'} />

    <!-- GALLERY SECTION -->
    <Gallery
        text={{ title: t('gallery.title'), subtitle: t('gallery.subtitle') }}
        lang={lang as 'sk' | 'en'}
    />

    <!-- BOOKING SECTION (Vue Island) -->
    <section
        id="rezervacia"
        class="py-24 md:py-32 bg-lunar-black relative overflow-hidden"
    >
        <!-- Background elements -->
        <div
            class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none"
        >
            <div
                class="absolute top-1/4 -left-20 w-96 h-96 rounded-full bg-lunar-gold blur-[100px]"
            >
            </div>
        </div>

        <div class="relative z-10 px-6">
            <BookingForm client:visible lang={lang as 'sk' | 'en'} />
        </div>
    </section>
    <!-- CONTACT SECTION -->
    <section id="kontakt" class="py-24 md:py-32 bg-lunar-dark relative">
        <div
            class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center"
        >
            <!-- Map -->
            <div
                class="w-full h-[400px] bg-neutral-900 rounded-lg overflow-hidden border border-white/5 relative group"
            >
                <iframe
                    title="Google Maps Location"
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2662.0000000000005!2d17.1044444!3d48.1444444!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x476c894444444445%3A0x4444444444444444!2sMichalsk%C3%A1%2012%2C%20811%2001%20Bratislava!5e0!3m2!1sen!2ssk!4v1234567890123!5m2!1sen!2ssk"
                    width="100%"
                    height="100%"
                    style="border:0; filter: grayscale(1) invert(0.9) contrast(1.2);"
                    allowfullscreen=""
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"
                    class="opacity-80 group-hover:opacity-100 transition-opacity duration-500"
                ></iframe>
            </div>

            <!-- Contact Info & Call Button -->
            <div class="text-center md:text-left flex flex-col gap-8">
                <div>
                    <h2
                        class="text-4xl md:text-5xl font-serif text-lunar-white mb-6"
                    >
                        {t('nav.contact')}
                    </h2>
                    <p
                        class="text-lunar-muted text-lg mb-4 leading-relaxed"
                        set:html={t('footer.desc')}
                    />

                    <div class="space-y-2 text-lunar-muted text-lg">
                        <p>Michalsk치 12, 811 01 Bratislava</p>
                        <p>hello@lunarbistro.sk</p>
                    </div>
                </div>

                <div>
                    <h3
                        class="text-lunar-gold uppercase tracking-widest text-sm mb-4 font-semibold"
                    >
                        {t('footer.hours.title')}
                    </h3>
                    <div class="space-y-2 text-lunar-muted">
                        <p>{t('footer.hours.week')}</p>
                        <p>{t('footer.hours.weekend')}</p>
                        <p>{t('footer.hours.sunday')}</p>
                    </div>
                </div>

                <a
                    href="tel:+421900000000"
                    class="inline-flex items-center gap-3 px-8 py-4 bg-lunar-gold text-lunar-black font-semibold hover:bg-white transition-colors duration-300 uppercase tracking-widest text-sm w-fit mx-auto md:mx-0"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        class="w-5 h-5"
                    >
                        <path
                            fill-rule="evenodd"
                            d="M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z"
                            clip-rule="evenodd"></path>
                    </svg>
                    +421 900 000 000
                </a>
            </div>
        </div>
    </section>
</Layout>

<style>
    .animate-pulse-slow {
        animation: pulse-slow 10s infinite;
    }
    @keyframes pulse-slow {
        0%,
        100% {
            opacity: 0.6;
        }
        50% {
            opacity: 0.8;
        }
    }
</style>
